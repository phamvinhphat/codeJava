package threeMusketeers;

/**
 * Three Musketeers
 * @author ptpha
 *
 */
import java.util.*;

public class Musketeers {
	Scanner sc = new Scanner(System.in);
	static String[][] a = new String[5][5];

	/*
	 * táº¡o mang 2 chieu
	 */
	public static void create_board() {
		for (int i = 0; i < 5; i++) {
			for (int j = 0; j < 5; j++) {
				a[i][j] = "R";
			}
		}
		a[0][4] = "M";
		a[2][2] = "M";
		a[4][0] = "M";

	}

	/*
	 * xuat mang 2 chieu
	 */
	public static void outputArray() {
		for (int i = 0; i < 5; i++) {
			for (int j = 0; j < 5; j++) {
				System.out.print(a[i][j] + "\t");
			}
			System.out.println("");
		}
	}

	/*
	 * so sanh huong di de duy chuyen ( chi duy chuyen co mot lan )
	 */
	public static void new_location(int row, int column, String direction) {
		if (direction.equalsIgnoreCase("left")) {
			a[row][column - 1] = "M";
			a[row][column] = " ";
			System.out.print("\nM di chuyen qua phia ben trai ");
		}
		if (direction.equalsIgnoreCase("right")) {
			a[row][column + 1] = "M";
			a[row][column] = " ";
			System.out.print("\nM di chuyen qua phia ben phai");
		}
		if (direction.equalsIgnoreCase("up")) {
			a[row + 1][column] = "M";
			a[row][column] = " ";
			System.out.print("\nM di chuyen xuong duoi");
		}
		if (direction.equalsIgnoreCase("down")) {
			a[row - 1][column] = "M";
			a[row][column] = " ";
			System.out.print("\nM di chuyen len tren ");
		}
	}

	/*
	 * kiem tra huong duy chuyen co hop phap ko
	 *
	 */
	public static boolean is_legal_move(int row, int column, String direction) {

		if (row < 5 && column < 5) {
			if (a[row][column] == "M") {
				if (direction.equalsIgnoreCase("left")) {
					if (column - 1 < 0) {
						return false;
					}
					if (a[row][column - 1] != "M" || a[row][column - 1] == " ") {
						return true;
					}
				}
				if (direction.equalsIgnoreCase("right")) {
					if (column + 1 > 4) {
						return false;
					}
					if (a[row][column + 1] != "M" || a[row][column + 1] == " ") {
						return true;
					}
				}
				if (direction.equalsIgnoreCase("up")) {
					if (row + 1 > 4) {
						return false;
					}
					if (a[row + 1][column] != "M" || a[row + 1][column] == " ") {
						return true;
					}
				}
				if (direction.equalsIgnoreCase("down")) {
					if (row - 1 < 0) {
						return false;
					}
					if (a[row - 1][column] != "M" || a[row - 1][column] == " ") {
						return true;
					}
				}
			}

			if (a[row][column] == "R") {
				if (direction.equalsIgnoreCase("left")) {
					if (column - 1 < 0) {
						return false;
					}
					if (a[row][column - 1] == " ") {
						return true;
					}
				}
				if (direction.equalsIgnoreCase("right")) {
					if (column + 1 > 4) {
						return false;
					}
					if (a[row][column + 1] == " ") {
						return true;
					}
				}
				if (direction.equalsIgnoreCase("up")) {
					if (row + 1 > 4) {
						return false;
					}
					if (a[row + 1][column] == " ") {
						return true;
					}
				}
				if (direction.equalsIgnoreCase("down")) {
					if (row - 1 < 0) {
						return false;
					}
					if (a[row - 1][column] == " ") {
						return true;
					}
				}
			}
		}
		return false;
	}

	/*
	 * kiem tra co hop phap ko de thuc hien viec di chuyen
	 *
	 */
	public static void make_move(int row, int column, String direction) {

		System.out.print("Kiem tra ");
		boolean bl = is_legal_move(row, column, direction);
		if (bl == true) {
			System.out.print("\ndi chuyen hop phap \n");
			new_location(row, column, direction);
			System.out.println("\nSau khi di chuyen : ");
			outputArray();
		} else {
			System.out.print("\ndi chuyen khong hop phap");
		}
	}

	/*
	 * cac huong ma linh ngu lam co the duy chuyen
	 */
	public static void choose_musketteer_more() {
		for (int i = 0; i < 5; i++) {
			for (int j = 0; j < 5; j++) {
				if (a[i][j] == "M") {
					if (is_legal_move(i, j, "left") == true) {
						System.out.println("a[" + i + "][" + j + "]");
						System.out.println("Co the di chuyen ben trai ");
						System.out.println("----------------");
					}
					if (is_legal_move(i, j, "right") == true) {
						System.out.println("a[" + i + "][" + j + "]");
						System.out.println("Co the di chuyen ben phai ");
						System.out.println("----------------");
					}
					if (is_legal_move(i, j, "up") == true) {
						System.out.println("a[" + i + "][" + j + "]");
						System.out.println("Co the di chuyen xuong ");
						System.out.println("----------------");
					}
					if (is_legal_move(i, j, "down") == true) {
						System.out.println("a[" + i + "][" + j + "]");
						System.out.println("Co the di chuyen len tren ");
						System.out.println("----------------");
					}
				}
			}
		}

	}

	/*
	 * cac huong ma linh co the duy chuyen
	 */
	public static void choose_enemy_move() {
		for (int i = 0; i < 5; i++) {
			for (int j = 0; j < 5; j++) {
				if (a[i][j] == "R") {
					if (is_legal_move(i, j, "left") == true) {
						System.out.println("a[" + i + "][" + j + "]");
						System.out.println("Co the di chuyen ben trai ");
						System.out.println("----------------");
					}
					if (is_legal_move(i, j, "right") == true) {
						System.out.println("a[" + i + "][" + j + "]");
						System.out.println("Co the di chuyen ben phai ");
						System.out.println("----------------");
					}
					if (is_legal_move(i, j, "up") == true) {
						System.out.println("a[" + i + "][" + j + "]");
						System.out.println("Co the di chuyen xuong ");
						System.out.println("----------------");
					}
					if (is_legal_move(i, j, "down") == true) {
						System.out.println("a[" + i + "][" + j + "]");
						System.out.println("Co the di chuyen len tren ");
						System.out.println("----------------");
					}
				}
			}
		}
	}
	/*
	 * linh ngu lam co mam cung hang hay cot khong
	 */

	public static boolean is_enemy_board() {
		int[] td = new int[3];
		int[] hd = new int[3];
		int n = 0;
		int k = 0;
		for (int i = 0; i < 5; i++) {
			for (int j = 0; j < 5; j++) {
				if (a[i][j] == "M") {
					td[n++] = i;
					hd[k++] = j;
				}
			}
		}

		if (td[0] == td[1] && td[1] == td[2] && td[2] == td[0]) {
			return true;
		}
		if (hd[0] == hd[1] && hd[1] == hd[2] && hd[2] == hd[0]) {
			return true;
		}

		return false;
	}

	public static void main(String args[]) {
		Scanner sc = new Scanner(System.in);
		byte chon;
		do {
			System.out.println("1: xuat");
			System.out.println("2: kiem tra duy chuyen co hop phap khong va di chuyen ");
			System.out.println("3: cac huong ma linh ngu lam co the duy chuyen ");
			System.out.println("4: cac huong ma linh co the duy chuyen");
			System.out.println("0: thoat");
			chon = sc.nextByte();
			switch (chon) {
			case 1:
				create_board();
				outputArray();
				break;

			case 2:
				System.out.println("Nhap so hang : ");
				int row = sc.nextInt();
				System.out.println("Nhap so cot : ");
				int column = sc.nextInt();
				System.out.println("Nhap huong di chuyen : ");
				sc.nextLine();
				String direction = sc.nextLine();
				System.out.print("Kiem tra ");
				make_move(row, column, direction);
				if (is_enemy_board() == true) {
					System.out.println("Linh ngu lam thua ");
					chon = 0;
				}
				break;

			case 3:
				System.out.print("huong duy chuyen cua linh ngu lam\n");
				choose_musketteer_more();
				break;

			case 4:
				System.out.print("huong duy chuyen cua linh thuong \n");
				choose_enemy_move();
				break;

			default:
				chon = 0;
				break;
			}
		} while (chon != 0);
		sc.close();

	}

}
